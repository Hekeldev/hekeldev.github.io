<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Music Player</title>

  <!-- Anti Zoom Mobile -->
  <meta name="viewport" 
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-black text-white min-h-screen flex flex-col">

<!-- HEADER -->
<div class="flex justify-between items-center p-4 bg-zinc-900">
  <h1 id="logo" class="text-xl font-bold cursor-pointer">ğŸ§ Music</h1>
  <button id="themeBtn" class="bg-zinc-700 px-3 py-1 rounded">ğŸŒ™</button>
</div>

<!-- MAIN -->
<div class="flex-1 p-4 space-y-4">

  <!-- SEARCH -->
  <div>
    <input id="searchInput" 
      class="w-full p-2 rounded text-black" 
      placeholder="Search lagu dari YouTube / YouTube Music">
    <button onclick="searchYT()" 
      class="w-full bg-green-600 p-2 rounded mt-2">
      Search
    </button>
  </div>

  <!-- RESULT -->
  <ul id="results" class="space-y-2"></ul>

  <!-- PLAYER -->
  <audio id="audio" controls class="w-full mt-4"></audio>

  <!-- YT PLAYER -->
  <div id="ytPlayer" class="hidden mt-3">
    <iframe id="ytFrame" class="w-full h-56 rounded" allow="autoplay"></iframe>
  </div>

  <!-- CONTROL -->
  <div class="flex justify-center gap-4">
    <button onclick="prev()" class="bg-zinc-800 px-4 py-2 rounded">â®</button>
    <button onclick="next()" class="bg-zinc-800 px-4 py-2 rounded">â­</button>
  </div>

</div>

<script>
/* ========== THEME ========== */
const themeBtn = document.getElementById("themeBtn");
let dark = true;

themeBtn.onclick = () => {
  dark = !dark;
  document.body.className = dark 
    ? "bg-black text-white min-h-screen flex flex-col"
    : "bg-white text-black min-h-screen flex flex-col";
  themeBtn.textContent = dark ? "ğŸŒ™" : "â˜€ï¸";
};

/* ========== BACK HOME ========== */
document.getElementById("logo").onclick = () => {
  window.location.href = "/";
};

/* ========== SEARCH YT (SIMPLE) ========== */
let playlist = [];
let current = 0;

function searchYT() {
  const q = document.getElementById("searchInput").value;
  if (!q) return;

  // Pake YouTube embed search (tanpa API key)
  const url = `https://www.youtube.com/results?search_query=${encodeURIComponent(q)}`;

  // Dummy playlist (manual play)
  playlist = [q];
  renderResults();
}

function renderResults() {
  const ul = document.getElementById("results");
  ul.innerHTML = "";

  playlist.forEach((title, i) => {
    const li = document.createElement("li");
    li.className = "bg-zinc-800 p-2 rounded cursor-pointer";
    li.textContent = title;

    li.onclick = () => playYT(title);
    ul.appendChild(li);
  });
}

/* ========== PLAY YT ========== */
function playYT(query) {
  const iframe = document.getElementById("ytFrame");
  iframe.src = `https://www.youtube.com/embed?listType=search&list=${encodeURIComponent(query)}&autoplay=1`;

  document.getElementById("ytPlayer").classList.remove("hidden");
}

/* ========== NEXT / PREV ========== */
function next() {
  current++;
  if (current >= playlist.length) current = 0;
  playYT(playlist[current]);
}

function prev() {
  current--;
  if (current < 0) current = playlist.length - 1;
  playYT(playlist[current]);
}

/* ========== BASS BOOST ========== */
const audio = document.getElementById("audio");
const AudioContext = window.AudioContext || window.webkitAudioContext;
const ctx = new AudioContext();

const source = ctx.createMediaElementSource(audio);
const bass = ctx.createBiquadFilter();

bass.type = "lowshelf";
bass.frequency.value = 200;   // Bass area
bass.gain.value = 15;        // Boost bass

source.connect(bass);
bass.connect(ctx.destination);

audio.onplay = () => ctx.resume();
</script>

</body>
</html>