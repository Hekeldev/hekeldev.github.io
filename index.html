<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Local Music Player</title>

  <!-- Anti Zoom Mobile -->
  <meta name="viewport" 
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-black text-white min-h-screen flex flex-col">

<!-- HEADER -->
<div class="flex justify-between items-center p-4 bg-zinc-900">
  <h1 id="logo" class="text-xl font-bold cursor-pointer">ğŸ§ My Music</h1>
  <button id="themeBtn" class="bg-zinc-700 px-3 py-1 rounded">ğŸŒ™</button>
</div>

<!-- MAIN -->
<div class="flex-1 p-4 space-y-4">

  <!-- UPLOAD -->
  <input type="file" id="fileInput" multiple accept="audio/*"
    class="w-full p-2 rounded bg-zinc-800">

  <!-- SORT -->
  <div class="flex gap-2">
    <button onclick="sortAdded()" class="bg-zinc-800 px-3 py-1 rounded">
      Urutan Ditambahkan
    </button>
    <button onclick="sortAZ()" class="bg-zinc-800 px-3 py-1 rounded">
      A - Z
    </button>
  </div>

  <!-- PLAYLIST -->
  <ul id="playlist" class="space-y-2"></ul>

  <!-- PLAYER -->
  <audio id="audio" controls class="w-full mt-4"></audio>

  <!-- CONTROLS -->
  <div class="flex justify-center gap-4">
    <button onclick="prev()" class="bg-zinc-800 px-4 py-2 rounded">â®</button>
    <button onclick="next()" class="bg-zinc-800 px-4 py-2 rounded">â­</button>
  </div>

</div>

<script>
/* THEME */
const themeBtn = document.getElementById("themeBtn");
let dark = true;

themeBtn.onclick = () => {
  dark = !dark;
  document.body.className = dark 
    ? "bg-black text-white min-h-screen flex flex-col"
    : "bg-white text-black min-h-screen flex flex-col";
  themeBtn.textContent = dark ? "ğŸŒ™" : "â˜€ï¸";
};

/* BACK HOME */
document.getElementById("logo").onclick = () => location.reload();

/* MUSIC DATA */
let songs = [];
let originalOrder = [];
let current = 0;

/* LOAD FILES */
document.getElementById("fileInput").addEventListener("change", e => {
  const files = Array.from(e.target.files);

  files.forEach(file => {
    songs.push({
      name: file.name,
      url: URL.createObjectURL(file)
    });
  });

  originalOrder = [...songs];
  render();
});

/* RENDER PLAYLIST */
function render() {
  const ul = document.getElementById("playlist");
  ul.innerHTML = "";

  songs.forEach((song, i) => {
    const li = document.createElement("li");
    li.className = "bg-zinc-800 p-2 rounded cursor-pointer";
    li.textContent = song.name;

    li.onclick = () => play(i);
    ul.appendChild(li);
  });
}

/* PLAY */
function play(i) {
  current = i;
  const audio = document.getElementById("audio");
  audio.src = songs[i].url;
  audio.play();
}

/* AUTO NEXT */
document.getElementById("audio").onended = next;

/* NEXT / PREV */
function next() {
  current++;
  if (current >= songs.length) current = 0;
  play(current);
}

function prev() {
  current--;
  if (current < 0) current = songs.length - 1;
  play(current);
}

/* SORT */
function sortAZ() {
  songs.sort((a, b) => a.name.localeCompare(b.name));
  render();
}

function sortAdded() {
  songs = [...originalOrder];
  render();
}

/* BASS BOOST */
const audio = document.getElementById("audio");
const AudioContext = window.AudioContext || window.webkitAudioContext;
const ctx = new AudioContext();

const source = ctx.createMediaElementSource(audio);
const bass = ctx.createBiquadFilter();

bass.type = "lowshelf";
bass.frequency.value = 200;
bass.gain.value = 15;

source.connect(bass);
bass.connect(ctx.destination);

audio.onplay = () => ctx.resume();
</script>

</body>
</html>