<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mp3Play - Home</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-black text-white min-h-screen flex flex-col">

  <div class="flex justify-between items-center p-4 bg-zinc-900">
    <h1 class="text-xl font-bold">ğŸ§ Spotify Pro</h1>
    <button id="themeBtn" class="bg-zinc-700 px-3 py-1 rounded">ğŸŒ™</button>
  </div>

  <div class="flex-1 p-4 space-y-4">

    <audio id="audio" controls class="w-full"></audio>

    <div>
      <p class="font-semibold mb-1">Local Music</p>
      <input type="file" id="fileInput" accept="audio/*" class="w-full" />
    </div>

    <div>
      <p class="font-semibold mb-1">YouTube URL</p>
      <input id="ytUrl" class="w-full p-2 text-black rounded" placeholder="https://youtube.com/watch?v=..." />
      <button onclick="loadYouTube()" class="w-full bg-green-600 p-2 rounded mt-2">Play YouTube</button>
    </div>

    <div id="ytPlayer" class="hidden">
      <iframe id="ytFrame" class="w-full h-56 rounded" allow="autoplay"></iframe>
    </div>

    <div class="flex gap-3">
      <a href="/player.html" class="flex-1 bg-zinc-800 p-2 rounded text-center">Now Playing</a>
      <a href="/history/" class="flex-1 bg-zinc-800 p-2 rounded text-center">History</a>
      <a href="/playlist/" class="flex-1 bg-zinc-800 p-2 rounded text-center">Playlist</a>
    </div>
  </div>

<script>
const audio = document.getElementById('audio');
const fileInput = document.getElementById('fileInput');

let playlist = JSON.parse(localStorage.getItem('playlist') || '[]');

fileInput.addEventListener('change', e => {
  const file = e.target.files[0];
  if (!file) return;

  const url = URL.createObjectURL(file);
  audio.src = url;
  audio.play();

  playlist.push({ name: file.name, url, type: 'local' });
  localStorage.setItem('playlist', JSON.stringify(playlist));
});

function loadYouTube() {
  const url = document.getElementById('ytUrl').value;
  const id = extractVideoId(url);
  if (!id) return alert('Invalid URL');

  document.getElementById('ytFrame').src = `https://www.youtube.com/embed/${id}?autoplay=1`;
  document.getElementById('ytPlayer').classList.remove('hidden');
  audio.pause();

  playlist.push({ name: 'YouTube', url, type: 'youtube' });
  localStorage.setItem('playlist', JSON.stringify(playlist));
}

function extractVideoId(url) {
  const m = url.match(/(v=|youtu.be\/)([\w-]{11})/);
  return m ? m[2] : null;
}

// Theme toggle
const themeBtn = document.getElementById('themeBtn');
let dark = true;

themeBtn.onclick = () => {
  dark = !dark;
  document.body.className = dark ? 'bg-black text-white min-h-screen flex flex-col'
                               : 'bg-white text-black min-h-screen flex flex-col';
  themeBtn.textContent = dark ? 'ğŸŒ™' : 'â˜€ï¸';
};
</script>

</body>
</html>