<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Mp3Player</title>

  <!-- Anti Zoom Mobile -->
  <meta name="viewport" 
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-black text-white min-h-screen flex flex-col">

<!-- HEADER -->
<div class="flex justify-between items-center p-4 bg-zinc-900">
  <h1 id="logo" class="text-xl font-bold cursor-pointer">ğŸ§ Music</h1>
  <button id="themeBtn" class="bg-zinc-700 px-3 py-1 rounded">ğŸŒ™</button>
</div>

<!-- MAIN -->
<div class="flex-1 p-4 space-y-4">

  <!-- SEARCH -->
  <div>
    <input id="searchInput" 
      class="w-full p-2 rounded text-black" 
      placeholder="Search lagu dari YouTube / YouTube Music">
    <button onclick="searchYT()" 
      class="w-full bg-green-600 p-2 rounded mt-2">
      Search
    </button>
  </div>

  <!-- PLAYER YT -->
  <div id="ytPlayer" class="hidden mt-3">
    <iframe 
      id="ytFrame" 
      class="w-full h-56 rounded"
      allow="autoplay"
      enablejsapi="1">
    </iframe>
  </div>

  <!-- CONTROL -->
  <div class="flex justify-center gap-4">
    <button onclick="prev()" class="bg-zinc-800 px-4 py-2 rounded">â®</button>
    <button onclick="next()" class="bg-zinc-800 px-4 py-2 rounded">â­</button>
  </div>

  <!-- LOCAL AUDIO -->
  <audio id="audio" controls class="w-full mt-4"></audio>

</div>

<script>
/* ========== THEME ========== */
const themeBtn = document.getElementById("themeBtn");
let dark = true;

themeBtn.onclick = () => {
  dark = !dark;
  document.body.className = dark 
    ? "bg-black text-white min-h-screen flex flex-col"
    : "bg-white text-black min-h-screen flex flex-col";
  themeBtn.textContent = dark ? "ğŸŒ™" : "â˜€ï¸";
};

/* ========== BACK HOME ========== */
document.getElementById("logo").onclick = () => {
  window.location.href = "/";
};

/* ========== SEARCH YOUTUBE ========== */
function searchYT() {
  const q = document.getElementById("searchInput").value;
  if (!q) return alert("Masukin judul lagu dulu!");

  const iframe = document.getElementById("ytFrame");

  iframe.src = `https://www.youtube.com/embed?listType=search&list=${encodeURIComponent(q)}&autoplay=1&enablejsapi=1`;

  document.getElementById("ytPlayer").classList.remove("hidden");
}

/* ========== NEXT / PREV ========== */
function next() {
  document.getElementById("ytFrame").contentWindow.postMessage(
    '{"event":"command","func":"nextVideo","args":""}',
    "*"
  );
}

function prev() {
  document.getElementById("ytFrame").contentWindow.postMessage(
    '{"event":"command","func":"previousVideo","args":""}',
    "*"
  );
}

/* ========== BASS BOOST (LOCAL AUDIO) ========== */
const audio = document.getElementById("audio");
const AudioContext = window.AudioContext || window.webkitAudioContext;
const ctx = new AudioContext();

const source = ctx.createMediaElementSource(audio);
const bass = ctx.createBiquadFilter();

bass.type = "lowshelf";
bass.frequency.value = 200;
bass.gain.value = 15;

source.connect(bass);
bass.connect(ctx.destination);

audio.onplay = () => ctx.resume();
</script>

</body>
</html>